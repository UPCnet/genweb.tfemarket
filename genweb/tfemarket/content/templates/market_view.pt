<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="ca"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="genweb.tfemarket">

    <body>
      <metal:content-core fill-slot="content-core">
        <metal:block define-macro="content-core"
                     tal:define="offers view/getOffers">
            <div metal:use-macro="context/batch_macros/macros/navigation" />
            <div id="offers" tal:condition="offers">
                <div id="contentSearchOffers">
                  <div id="headerSearchOffers">
                    <h2 style="margin-top:0px; text-align: left;" i18n:translate="">Search</h2>
                    <div style="float:right;" class="documentDescription">
                        <span id="expandSearch"><span i18n:translate="">Show</span> <i style="color: #557c95" class="fa fa-chevron-down" aria-hidden="true"></i></span>
                        <span id="collapseSearch"><span i18n:translate="">Hide</span> <i style="color: #557c95" class="fa fa-chevron-up" aria-hidden="true"></i></span>
                    </div>
                  </div>
                  <form id="searchOffers" name="searchOffers" action="" method="post">
                    <label i18n:translate="">Text to search</label>
                    <input type="text" id="searchTitle" name="title" />

                    <label i18n:translate="">Certification</label>
                    <select id="searchCertification" name="certification">
                      <option value="all">All</option>
                      <!-- <tal:block tal:repeat="certification view/listCertifications">
                        <option value="certification" tal:content="certification">Certification</option>
                      </tal:block> -->
                    </select>

                    <label i18n:translate="">Departament</label>
                    <select id="searchDepartament" name="departament">
                      <option value="all">All</option>
                      <!-- <tal:block tal:repeat="certification view/listCertifications">
                        <option value="certification" tal:content="certification">Certification</option>
                      </tal:block> -->
                    </select>

                    <label i18n:translate="">Company</label>
                    <select id="searchCompany" name="company">
                      <option value="all" i18n:translate="">All</option>
                      <!-- <tal:block tal:repeat="certification view/listCertifications">
                        <option value="certification" tal:content="certification">Certification</option>
                      </tal:block> -->
                    </select>

                    <label i18n:translate="">Date</label>
                    <select id="searchDate" name="date">
                      <tal:block tal:repeat="date view/getDates">
                        <option tal:attributes="value date" tal:content="date">Date</option>
                      </tal:block>
                    </select>

                    <label i18n:translate="">Keywords</label>
                    <br>
                    <br>

                    <input type="checkbox" id="searchGrant" name="grant" />
                    <span i18n:translate="">With the possibility of offering grant/financing</span>

                    <div class="multicheckLine" id="searchLanguage">
                      <label i18n:translate="">Developer language</label>
                      <tal:block tal:repeat="lang view/getLanguages">
                        <input type="checkbox" name="language"
                               tal:attributes="value lang;" />
                        <span tal:content="lang">Language</span>
                      </tal:block>
                    </div>

                    <div class="multicheckLine" id="searchModality">
                      <label i18n:translate="">Modality</label>
                      <tal:block tal:repeat="modality view/getModalities">
                        <input type="checkbox" name="modality"
                               tal:attributes="value modality;" />
                        <span tal:content="modality">Modality</span>
                      </tal:block>
                    </div>

                    <button id="offersFilter" form="offersFilter">
                      <span class="fa fa-search"></span>
                      <span i18n:translate="">Search</span>
                    </button>
                  </form>
                </div>
                <div class="clearfix"></div>
                <div id="headerOffers">
                  <h2 style="margin-top:0px; text-align: left; float: left;" i18n:translate="">All TFE's</h2>
                  <div style="float:right;" class="documentDescription">
                      <span id="expandAll" i18n:translate="">Desplega tot <i style="color: #557c95" class="fa fa-chevron-down" aria-hidden="true"></i></span>
                      <span id="collapseAll" i18n:translate="">Plega tot <i style="color: #557c95" class="fa fa-chevron-up" aria-hidden="true"></i></span>
                  </div>
                </div>
                <ul id="offersList">
                    <tal:offers repeat="offer offers">
                        <li class="unstyled offer">
                            <div class="puntTitle span12">
                                <div class="span1 fletxaSpan">
                                    <button type="button" class="expand"
                                            data-original-title="Expand">
                                        <i style="color: #557c95" class="fa fa-chevron-down" aria-hidden="true"></i>
                                    </button>
                                    <button type="button" class="notexpand"
                                            data-original-title="Collapse">
                                        <i  style="color: #557c95" class="fa fa-chevron-up" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div class="span10 titleSpan">
                                    <h3><a tal:attributes="href offer/url">
                                        <tal:omit-tag tal:content="offer/title">Item Title</tal:omit-tag>
                                    </a></h3>
                                </div>
                                <div class="span1 boleta">
                                    <span class="btn label disabled" style="padding:3px; float: right;">
                                        <i class="fa fa-circle" aria-hidden="true"></i>&nbsp;<span tal:content="offer/state"></span>
                                    </span>
                                </div>
                            </div>
                            <div class="sortable2 offerdata">
                                <p class="offerdesc">Descripción: The project aims to develop an Energy Management Dystem (EMS) for microgrids based on renewable energies. An optimization problem will be formulated taking into account a given electrical microgrid with a number of electrical constraints. The EMS will schedule the power set-points for the different nodes considering the energy production and demand forecasts as long as the considered constraints. The developed EMS can be tested in an experimental microgrid.</p>
                                    <div><p>Requisitos mínimos:</p>
                                        <ul>
                                            <li>MSc RENE - Renewable Energy</li>
                                            <li>MSc Energy for Smart Cities</li>
                                            <li>MSc SENSE - Smart Electrical Networks and Systems</li>
                                            <li>MSc SELECT - Environomical Pathways for Sustainable Energy Systems</li>
                                        </ul>
                                    </div>
                            </div>
                            <div tal:define="applications python:view.getApplications(offer)"
                                 tal:condition="applications"
                                 class="sortable2 applications">
                                <tal:applications repeat="app applications">
                                    <ol>
                                        <div>
                                            <div class="span9">
                                                <a tal:attributes="href app/url">
                                                    <tal:omit-tag tal:content="app/title">Item Title</tal:omit-tag>
                                                </a>
                                            </div>
                                            <div class="span2">
                                                  <i class="fa fa-circle" aria-hidden="true"></i>
                                                <tal:block tal:define="estat app/state">
                                                    <span class="btn label disabled" style="padding:3px; float: right;">
                                                    <i class="fa fa-circle" aria-hidden="true"></i>&nbsp;<span tal:content="estat"></span>
                                                    </span>
                                                </tal:block>
                                            </div>
                                        </div>
                                    </ol>
                                </tal:applications>
                            </div>
                        </li>
                    </tal:offers>
                </ul>
        </div>
        </metal:block>



  <script type="text/javascript">
    $(function() {
        $('.expand').click(function(){
           $(this).hide();
           $(this).parent().find('.notexpand').show();
           $(this).parent().parent().parent().find('.sortable2').slideDown();
        });

        $('.notexpand').click(function(){
           $(this).hide();
           $(this).parent().find('.expand').show();
           $(this).parent().parent().parent().find('.sortable2').slideUp();
        });

        $("#headerSearchOffers").click(function(){
          if( $("#collapseSearch").is(":visible") ){
            $("#searchOffers").slideUp();
            $("#expandSearch").show();
            $("#collapseSearch").hide();
          }else{
            $("#searchOffers").slideDown();
            $("#expandSearch").hide();
            $("#collapseSearch").show();
          }
        });

        $("#expandAll").click(function(){
          $(".expand").parent().parent().parent().slideDown();
          $(".expand").hide();
          $(".notexpand").show();
          $(".expand").parent().parent().parent().find('.sortable2').slideDown();
          $("#expandAll").hide();
          $("#collapseAll").show();
        })

        $("#collapseAll").click(function(){
          $(".notexpand").slideUp();
          $(".notexpand").hide();
          $(".expand").show();
          $(".expand").parent().parent().parent().find('.sortable2').slideUp();
          $("#expandAll").show();
          $("#collapseAll").hide();
        })

        $('input[name="language"]').prop('checked', true);
        $('input[name="modality"]').prop('checked', true);
    });
  </script>

  <!-- <script type="text/javascript">
    $(function() {
      $('#offersFilter').on('click', function(){
        $.ajax({
            method: 'POST',
            url: location.href,
            data: {
                    title : $('#searchTitle').val(),
                    certification : $('#searchCertification').val(),
                    departament : $('#searchDepartament').val(),
                    company : $('#searchCompany').val(),
                    date : $('#searchDate').val(),
                    grant : $('#searchGrant').prop('checked'),
                    languages : $('input[name="language"]:checked').map(function(){ return this.value; }).get().join(','),
                    modalities : $('input[name="modality"]:checked').map(function(){ return this.value; }).get().join(','),
                  },
            success: function(){}
        });
      });
    });
  </script> -->
</metal:content-core>
</body>
</html>
